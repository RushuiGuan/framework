trigger:
- staging

pool:
  vmImage: 'windows-latest'


steps:

- task: DotNetCoreCLI@2
  displayName: 'Restore'
  inputs:
    command: 'restore'
    projects: './framework.sln'
    feedsToUse: 'select'
    vstsFeed: 'Staging'

- task: DotNetCoreCLI@2
  displayName: 'Pack'
  inputs:
    command: 'pack'
    packagesToPack: './src/**/*.csproj'
    includesymbols: false
    versioningScheme: 'off'
    verbosityPack: 'Normal'

- task: NuGetCommand@2
  displayName: 'Nuget Push'
  inputs:
    command: 'push'
    packagesToPush: '$(Build.ArtifactStagingDirectory)/*.nupkg'
    nuGetFeedType: 'internal'
    publishVstsFeed: 'Staging'
    allowPackageConflicts: true
